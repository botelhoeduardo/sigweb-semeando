$(document).ready(function(){var e=function(){return[new ol.style.Style({fill:new ol.style.Fill({color:"rgba(225, 130, 41, 0.6)"}),stroke:new ol.style.Stroke({color:"rgba(225, 92, 41, 0.8)",width:1})})]},o={},t=function(e,t){var r=e.get("features").length,l=1==r&&60>t?e.get("features")[0].get("name"):r.toString();o[r];return[new ol.style.Style({image:new ol.style.Circle({radius:10,fill:new ol.style.Fill({color:"rgb(225, 130, 41)"}),stroke:new ol.style.Stroke({color:"rgb(225, 92, 41)",width:1})}),text:new ol.style.Text({scale:1.2,text:l,fill:new ol.style.Fill({color:"#fff"}),stroke:new ol.style.Stroke({color:"#000"})})})]},r=function(e,o){var t=e.get("features").length,l=1==t&&60>o?e.get("features")[0].get("name"):t.toString();r[t];return[new ol.style.Style({image:new ol.style.Circle({radius:10,fill:new ol.style.Fill({color:"rgb(180, 10, 10)"}),stroke:new ol.style.Stroke({color:"rgb(180, 10, 10)",width:1})}),text:new ol.style.Text({scale:1.2,text:l,fill:new ol.style.Fill({color:"#fff"}),stroke:new ol.style.Stroke({color:"#000"})})})]},l=function(e){return[new ol.style.Style({stroke:new ol.style.Stroke({color:"rgba(160,140,0,1)",width:3})})]},n=function(e){return[new ol.style.Style({image:new ol.style.Circle({radius:5,stroke:new ol.style.Stroke({color:"rgba(0,127,255,0.8)",width:1})}),stroke:new ol.style.Stroke({color:"rgba(0,127,255,0.8)",width:1})})]},a=function(e,o){var t=20>o?e.get("name"):"";return[new ol.style.Style({stroke:new ol.style.Stroke({color:"#A62A2A",width:2.5}),text:new ol.style.Text({scale:1.5,text:t,fill:new ol.style.Fill({color:"#fff"}),stroke:new ol.style.Stroke({color:"#000",width:1.7})})})]},s=function(e){return[new ol.style.Style({image:new ol.style.Icon({size:[125,125],src:"img/viv_ico2.png"})})]},i=function(){return[new ol.style.Style({fill:new ol.style.Fill({color:"rgba(0, 238, 118, 0.3)"}),stroke:new ol.style.Stroke({color:"rgb(0, 238, 118)",width:1})})]};ol.proj.get("EPSG:3857");view=new ol.View({center:[-6942316.656972848,-1050856.264864603],zoom:9,maxZoom:18,minZoom:2});var c=new ol.layer.Tile({source:new ol.source.OSM({layer:"osm"}),visible:!1,name:"mapquest"}),u=new ol.layer.Tile({source:new ol.source.BingMaps({key:"Aqh3opxIgZXX9tgD-qzCGUijcoJU_6cZfUrKzB6sWLUhddRjsXTIuRwzz7E7DDYe",imagerySet:"Aerial"}),visible:!0,name:"bingmaps"}),m=new ol.layer.Vector({source:new ol.source.Vector({url:"data/kml/rad_pol_semeando_2010_2015.kml",format:new ol.format.KML({extractStyles:!1})}),style:e,name:"lotesLayer",visible:!1}),y=new ol.source.Vector({url:"data/kml/rad_pts_semeando_2010_2015.kml",format:new ol.format.KML({extractStyles:!1})}),w=new ol.layer.Vector({source:new ol.source.Vector({url:"data/geojson/limite_semeando.geojson",format:new ol.format.GeoJSON,extractStyles:!1}),style:l,name:"limlayer",visible:!0}),g=(new ol.layer.Vector({source:new ol.source.Vector({url:"data/geojson/rad_pol_semeando_2010_2015.geojson",format:new ol.format.GeoJSON}),style:e,name:"aterlayer",visible:!1}),new ol.layer.Vector({source:new ol.source.Vector({url:"data/geojson/drenagem_semeando.geojson",format:new ol.format.GeoJSON({})}),style:n,name:"drenagemLayer",visible:!1})),d=new ol.layer.Vector({source:new ol.source.Vector({url:"data/kml/flona_jamari.kml",format:new ol.format.KML({extractStyles:!1})}),style:i,name:"flonaLayer",visible:!1}),f=new ol.source.Vector({url:"data/kml/car_2.kml",format:new ol.format.KML({extractStyles:!1})}),p=new ol.layer.Vector({source:new ol.source.Vector({url:"data/kml/estradas.kml",format:new ol.format.KML({extractStyles:!1})}),style:a,name:"estradasLayer",visible:!1}),v=new ol.layer.Vector({source:new ol.source.Vector({url:"data/kml/viveiro_itapua.kml",format:new ol.format.KML({extractStyles:!1})}),style:s,name:"viveiroLayer",visible:!1}),S=new ol.source.Cluster({distance:40,source:y}),b=new ol.layer.Vector({source:S,style:t,name:"clusters",visible:!1}),k=new ol.source.Cluster({distance:40,source:f}),h=new ol.layer.Vector({source:k,style:r,name:"carLayer",visible:!1});map=new ol.Map({target:"mapa",controls:ol.control.defaults().extend([new ol.control.ScaleLine({className:"ol-scale-line",target:document.getElementById("scale-line")}),new ol.control.Zoom({zoomInTipLabel:"Mais zoom",zoomOutTipLabel:"Menos zoom"}),new ol.control.Attribution({tipLabel:"Atribuições"})]),renderer:"canvas",layers:[c,u,w,d,g,p,m,b,v,h],view:view}),$("input[type=checkbox]").on("change",function(){var e={arearad:[b,m],areacar:h,drenagem:g,limsemeando:w,estradas:p,viveiro:v,ucs:d}[$(this).attr("id")];Array.isArray(e)?e.forEach(function(e){e.setVisible(!e.getVisible())}):e.setVisible(!e.getVisible())}),$("input[type=radio]").on("change",function(){var e=$(this).val();map.getLayers().getArray().forEach(function(o){var t=o.get("name");"lotesLayer"!=t&&"drenagemLayer"!=t&&"zseeLayer"!=t&&"aterlayer"!=t&&"limlayer"!=t&&"sedeRadLayer"!=t&&"carLayer"!=t&&"estradasLayer"!=t&&"clusters"!=t&&"viveiroLayer"!=t&&"resexLayer"!=t&&"flonaLayer"!=t&&o.setVisible(t==e)})});var x=new ol.Geolocation({projection:view.getProjection(),tracking:!0});$("#geolocation").click(function(){var e=x.getPosition(),o=new ol.layer.Vector({source:new ol.source.Vector({features:[new ol.Feature({geometry:new ol.geom.Point(e),name:"geolocation"})]})});return map.addLayer(o),view.setCenter(e),view.setResolution(2.388),!1}).mouseover(function(){var e=$(this).css("border");$(this).css("border","#0061f2 2px solid"),$(this).bind("mouseout",function(){$(this).css("border",e)})});var L=$("#info");L.tooltip({animation:!1,trigger:"manual"});var V=function(e){L.css({left:e[0]+"px",top:e[1]+22+"px"});var o=map.forEachFeatureAtPixel(e,function(e){return e});o.get("name")||o.get("features")?L.tooltip("hide").attr("data-original-title",o.get("features")?o.get("features")[0].get("name"):o.get("name")).tooltip("fixTitle").tooltip("show"):L.tooltip("hide")};drawing=!1,map.on("pointermove",function(e){return e.dragging||!map.hasFeatureAtPixel(e.pixel)||1==drawing?void L.tooltip("hide"):void V(map.getEventPixel(e.originalEvent))});var P=new ol.style.Style({image:new ol.style.Circle({radius:5,fill:new ol.style.Fill({color:"rgba(255, 255, 0, 0.4)"}),stroke:new ol.style.Stroke({color:"rgba(255, 225, 0, 0.6)",width:2})}),fill:new ol.style.Fill({color:"rgba(255, 255, 0, 0.4)"}),stroke:new ol.style.Stroke({color:"rgba(255, 255, 0, 0.6)",width:2})}),_=new ol.interaction.Select({layers:function(e){return 1==e.get("selectable")},style:[P]});map.getInteractions().extend([_]),m.set("selectable",!0),k.set("selectable",!0);var E=document.getElementById("popup"),M=document.getElementById("popup-content"),j=document.getElementById("popup-coord"),A=document.getElementById("popup-closer"),F=new ol.Overlay({element:E,autoPan:!0,autoPanAnimation:{duration:250}});map.addOverlay(F),A.onclick=function(){return F.setPosition(void 0),A.blur(),!1},map.on("singleclick",function(e){var o=map.forEachFeatureAtPixel(e.pixel,function(e,o){return e});if(o&&o.get("description")){var t=e.coordinate,r=ol.coordinate.toStringHDMS(ol.proj.transform(t,"EPSG:3857","EPSG:4326"));M.innerHTML="<p>"+o.getProperties().description+"</p>",j.innerHTML="<p><strong>"+r+"</strong></p>",F.setPosition(t),$("#owl-demo").owlCarousel({jsonPath:"img/viveiro.json"})}else if(o&&(o.get("description")||o.get("features"))){if(o&&1==o.get("features").length){var t=e.coordinate,r=ol.coordinate.toStringHDMS(ol.proj.transform(t,"EPSG:3857","EPSG:4326"));M.innerHTML="<p>"+o.get("features")[0].get("description")+"</p>",j.innerHTML="<p><strong>"+r+"</strong></p>",F.setPosition(t)}}else F.setPosition()})});